(function(e,t){var n={Base:"https://api.built.io/v1",register:"/application/users/",login:"/application/users/login/",logout:"/application/users/logout/",user:"/application/users/",getUserInfo:"/application/users/current/",classes:"/classes/",objects:"/objects/",upload:"/uploads/",version:"/v1/",host:"api.built.io",proto:"https://",forgetPassword:"/application/users/forgot_password/request_password_reset/",role:"/built_io_application_user_role/objects/",notification:"/push/",cloudCodeRun:"https://cloud.built.io/api/"},r,s,o=null,u,a,f=false,l=typeof exports!=="undefined"&&typeof module!=="undefined"&&typeof module.exports!=="undefined"&&typeof navigator==="undefined"?true:false,c=l?function(){var e=arguments[0],t=Array.prototype.slice.apply(arguments,[1,arguments.length]);process.nextTick(function(){e.apply(e,t)})}:function(){var e=arguments[0],t=Array.prototype.slice.apply(arguments,[1,arguments.length]);setTimeout(function(){e.apply(e,t)},0)};if(l){r=exports;a=require("request")}else{r=e.Built={}}r.VERSION="1.0.0.3";if(typeof console==="undefined"){console={};console.log=function(){}}var h={},p={},d=function(){return Math.floor(Math.random()*123456789)},v=function(e){return e.replace(/[\/]+/g,"/").replace(":/","://").replace(/[\/]$/,"")},m=function(e){for(var t in e){return false}return true},g=function(e,t){var n=this;var i;if(e&&Object.prototype.hasOwnProperty.call(e,"constructor")){i=e.constructor}else{i=function(){return n.apply(this,arguments)}}r.Util.extend(i,n,t);var s=function(){this.constructor=i};s.prototype=n.prototype;i.prototype=new s;if(e)r.Util.extend(i.prototype,e);i.__super__=n.prototype;return i},y=function(e){var t=new r.Promise;t.success=t.onSuccess=t.done;t.error=t.onError=t.fail;t.onAlways=t.always;delete t.done;delete t.fail;t.onSuccess(e.onSuccess);t.onError(e.onError);t.onAlways(e.onAlways);e.onSuccess=t.resolve;e.onError=t.reject;return t};(function(e){var t=e;t.initialize=function(e,n){h={},p={},o=null;if(typeof e=="object"){if(e.application_api_key&&e.application_uid){h["application_api_key"]=e.application_api_key;h["application_uid"]=e.application_uid}}else{if(typeof e=="string"){h["application_api_key"]=e}if(typeof n=="string"){h["application_uid"]=n}}return t};t.init=t.initialize;t.setTenant=function(e){if(typeof e=="string"){t.setHeaders("tenant_uid",e)}return t};t.fn=t.__proto__?t.__proto__:t.prototype;t.setHeaders=function(e,n){if(t.Util.dataType(e)=="object"){h=t.Util.mix(h,e)}else if(typeof e=="string"&&typeof n=="string"){h[e]=n}if(h["authtoken"]){if(t.Util.dataType(o)!="object"){o={authtoken:h["authtoken"]}}}return t};t.getHeaders=function(){return t.Util.clone(h)};t.setURL=function(e,r){if(e){n.host=e}if(typeof r=="string"&&r.indexOf("https")>=0){n.proto="https://"}else if(typeof r=="string"&&r.indexOf("http")>=0){n.proto="http://"}n.Base=v(n.proto+n.host+n.version);return t};t.addQueryString=function(e,n){if(typeof e=="string"&&typeof n=="string"){if(n==""&&p[e]){delete p[e];return}p[e]=n}return t}})(r);(function(e){var t=e;t.Cache={};t.Cache.onlyCache=function(){s="only_cache";return t};t.Cache.onlyNetwork=function(){s="only_network";return t};t.Cache.cacheElseNetwork=function(){s="cache_else_network";return t};t.Cache.networkElseCache=function(){s="network_else_cache";return t};t.Cache.cacheThenNetwork=function(){s="cache_then_network";return t}})(r);(function(e){var n=e;n.Util={};n.Util.parallel=function(e,t){if(this.dataType(e)=="object"){var n=this;var r=function(){var r=0,i=0,s=null,o={};for(var u in e){r+=1}var a=function(e){var n=e,u=function(){return function(e,u){if(e!=null){if(s==null&&typeof t=="function"){t(e,null);s=true}e=s}else{i+=1;o[n]=u;if(i>=r&&typeof t=="function"){t(s,o)}}}};return new u};for(var u in e){e[u](a(u))}return n};return new r}else{throw new Error("Object parameters required for parallel tasks")}return this};n.Util.param=function(e,t){var n=[],r,i=/%20/g,s=function(e,r){r=r==null?"":r;if(t){n[n.length]=e+"="+r}else{n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(r)}};if(this.dataType(e)=="object"){for(var r in e){this.__buildParams__(r,e[r],s)}}else{var o=JSON.parse(e);for(var r in o){this.__buildParams__(r,o[r],s)}}return n.join("&").replace(i,"+")};n.Util.__buildParams__=function(e,t,n){var r=/\[\]$/;if(this.dataType(t)=="array"){for(var i=0;i<t.length;i++){if(r.test(e)){n(e,t[i])}else{this.__buildParams__(e+"["+(isNaN(i)?i:"")+"]",t[i],n)}}}else if(this.dataType(t)=="object"){for(name in t){this.__buildParams__(e+"["+name+"]",t[name],n)}}else{n(e,t)}};n.Util.dataType=function(e){var n=Object.prototype.toString.call(e);if(e===t){return"undefined"}else if(e===null){return"null"}else if(n.indexOf("Element")>=0||typeof e.tagName!=="undefined"){return"element"}else if(n=="[object Boolean]"){return"boolean"}else if(n=="[object Array]"){return"array"}else if(n=="[object Object]"){return"object"}else if(n=="[object Function]"){return"function"}else if(n=="[object Number]"||isNaN(e)==false&&e!=""){return"number"}else if(n=="[object String]"){return"string"}else{return"unknown"}};n.Util.mix=function(e,t){if(typeof e=="object"&&typeof t=="object"){var n=this.clone(e);for(var r in t){n[r]=t[r]}return n}};n.Util.clone=function(e){var t={};for(var n in e){t[n]=e[n]}return t};n.Util.each=function(e,t,n){var r=Array.prototype.forEach,i={};if(e==null)return;if(r&&e.forEach===r){e.forEach(t,n)}else if(e.length===+e.length){for(var s=0,o=e.length;s<o;s++){if(t.call(n,e[s],s,e)===i)return}}else{for(var u in e){if(e[u]){if(t.call(n,e[u],u,e)===i)return}}}};n.Util.extend=function(e){var t=Array.prototype.slice;this.each(t.call(arguments,1),function(t){if(t){for(var n in t){e[n]=t[n]}}});return e};n.Util.deparam=function(e,n){try{var r={},i={"true":!0,"false":!1,"null":null};var s=e.replace(/\+/g," ").split("&");var o=s.length;for(var u=0;u<o;u++){var a=s[u].split("="),f=decodeURIComponent(a[0]),l,c=r,h=0,p=f.split("]["),d=p.length-1;if(/\[/.test(p[0])&&/\]$/.test(p[d])){p[d]=p[d].replace(/\]$/,"");p=p.shift().split("[").concat(p);d=p.length-1}else{d=0}if(a.length===2){l=decodeURIComponent(a[1]);if(n){l=l&&!isNaN(l)?+l:l==="undefined"?t:i[l]!==t?i[l]:l}if(d){for(;h<=d;h++){f=p[h]===""?c.length:p[h];c=c[f]=h<d?c[f]||(p[h+1]&&isNaN(p[h+1])?{}:[]):l}}else{if(this.dataType(r[f])=="array"){r[f].push(l)}else if(r[f]!==t){r[f]=[r[f],l]}else{r[f]=l}}}else if(f){r[f]=n?t:""}}return r}catch(v){throw v}}})(r);(function(e){var t=e;t.File=function(){var e={};this.add=function(n,r,i,s){if(n&&r){try{if(typeof r[0]!=="undefined"){r=r[0]}}catch(o){}if(t.Util.dataType(r)=="element"||typeof FormData!=="undefined"&&r instanceof FormData){e[n]={file:r,attributes:i,options:s}}else{throw new Error("Not supported object type for upload, add HTML Input File Element")}}else{throw new Error("Key and File parameters required")}return this};this.upload=function(n){n=n||{};var i=this;if(m(e)==true){throw new Error("No file found for upload");return}var s=function(t,r){if(t){if(typeof n.onError=="function"){n.onError(t,r)}}else{if(typeof n.onSuccess=="function"){e={};n.onSuccess(r)}}};t.Util.parallel(r(),s)};var r=function(){var t={};for(var r in e){var s=false;if(typeof e[r]["options"]=="object"&&e[r]["options"]["id"]){s=true}t[r]=function(e,t){return function(r){var s=e["file"];var o={onSuccess:function(e,t){r(null,e)},onError:function(e,t){r(e,e)}};var u=v(n.Base+n.upload+(t?e["options"]["id"]:"")),a=e["attributes"]||{},f=e["options"]||{};i(u,h,s,o,a,f)}}(e[r],s)}return t};var i=function(e,t,r,i,o,u){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}i=i||{};var a=function(e,t){try{e=JSON.parse(e)}catch(n){}if(typeof e=="object"&&typeof e.notice!=="undefined"){if(typeof i.onSuccess=="function"){i.onSuccess(e.upload,t)}}else{if(typeof i.onError=="function"){i.onError(e,t)}}};s(e,t,r,a,o,u)};var s=function(e,r,i,s,u,a){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}r=r||{};u=u||{};s=s||function(){};if(typeof window=="object"&&typeof window.FormData!=="undefined"){var f=new XMLHttpRequest,l;if(i instanceof FormData){l=i}else if(t.Util.dataType(i)=="element"){l=new FormData;if(i.getAttribute("type")=="file"&&i.getAttribute("name")){l.append("upload[upload]",i.files[0])}else{s({error_message:"Input File Element Required"},null);throw new Error("Input File Element Required")}}else{throw new Error("HTML Input File Element or FormData Required for upload")}for(var c in u){l.append("upload["+c+"]",u[c])}if(a&&a.id){l.append("_method","put")}f.open("POST",e,true);if(t.Util.dataType(r)=="object"){for(var h in r){f.setRequestHeader(h,r[h])}}if(typeof s=="function"){f.onreadystatechange=function(t){if(f.readyState==4&&f.status!=0){s(f.responseText,f)}else if(f.readyState==4&&f.status==0){o(e,r,i,s,u,a)}}}if(typeof a.onprogress=="function"&&typeof f.upload=="object"){f.upload.onprogress=a.onprogress}f.ontimeout=function(e){var t={error_message:"error occured",http:f,event:e};s(f.responseText,f,t)};f.onerror=f.ontimeout;f.send(l)}else{o(e,r,i,s,u,a)}};var o=function(e,n,r,i,s,o){if(typeof r[0]!=="undefined"){r=r[0]}if(t.Util.dataType(r)=="element"){if(r.getAttribute("type")=="file"){var a=r.cloneNode();r.style.display="none";r.parentNode.insertBefore(a,r);var f="POST";var l=d().toString();if(typeof t.cbTray!="object"){t.cbTray={}}t.cbTray[l]=i;var c=C(e,n,r,f,l);var h=u(e,n,r,f,l,s,o);h.submit()}else{i({error_message:"Input File Element Required"},null);throw new Error("Input File Element Required")}}else{i({error_message:"HTML Input File Element or FormData Required for upload"},null);throw new Error("HTML Input File Element or FormData Required for upload")}};var u=function(e,t,r,i,s,o,u){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}i=i.toUpperCase();var a=document.createElement("form");a.setAttribute("id","form_"+s);a.setAttribute("target","frame_"+s);a.setAttribute("method","post");a.setAttribute("height","0");a.setAttribute("width","0");a.setAttribute("style","display:none");a.setAttribute("enctype","multipart/form-data");a.setAttribute("encoding","multipart/form-data");e=v(e)+".postmessage";a.setAttribute("action",e);for(var f in t){try{a.appendChild(A(f.toString().toUpperCase(),t[f]))}catch(l){}}r.setAttribute("name","upload[upload]");a.appendChild(r);for(var c in o){a.appendChild(A("upload["+c+"]",o[c]))}if(typeof u=="object"&&u.id){a.appendChild(A("_method","put"))}a.appendChild(A("postmessage_payload",s));a.appendChild(A("host",document.location.origin?document.location.origin:document.location.protocol+"//"+document.location.host));document.body.appendChild(a);return a}}})(r);(function(e){var t=e;t.FileObject=function(e){var n;var r={};var i={};var s=null;if(typeof e=="string"){n=e;r.uid=e}else if(t.Util.dataType(e)=="object"&&typeof e["uid"]=="string"){r=e;n=e.uid}this.addFile=function(e){if(e){if(typeof e[0]!=="undefined"){e=e[0]}if(t.Util.dataType(e)=="element"||typeof FormData!=="undefined"&&e instanceof FormData){i["upload"]=e}else{throw new Error("Not supported object type for upload, add HTML Input File Element or FormData")}}else{throw new Error("File parameters required")}return this};this.setTags=function(e){var n=e;if(t.Util.dataType(n)==="array"){n=n.join(",")}if(n.indexOf(" ")>=0){n=n.split(" ").join(",")}i["tags"]=n;return this};this.setACL=function(e){if(typeof e=="object"&&typeof e.toJSON=="function"){var t=e.toJSON();if(t.others&&t.roles&&t.users){i["ACL"]=t}}return this};this.destroy=function(e){if(n){e=e||{};var t=this,s={},o=y(e),u=function(t,s){try{t=JSON.parse(t)}catch(o){}if(typeof t=="object"&&typeof t.notice!=="undefined"){n=null;r={};i={};if(typeof e.onSuccess=="function"){e.onSuccess(t,s)}}else{if(typeof e.onError=="function"){e.onError(t,s)}}};s.uid=n;var a=b.upload.destroy(h,{},u,s);o._HTTP=a._HTTP;o.abort=a.abort;return o}else{throw new Error("Set upload UID first")}};this.fetch=function(e){if(n){e=e||{};var t=this,s=y(e),o=function(t,s){try{t=JSON.parse(t)}catch(o){}if(typeof t=="object"&&typeof t.upload!=="undefined"){r=t.upload;n=r.uid;i={};if(typeof e.onSuccess=="function"){e.onSuccess(t,s)}}else{if(typeof e.onError=="function"){e.onError(t,s)}}};var u={uid:n};var a=b.upload.fetch(h,{},o,u);s._HTTP=a._HTTP;s.abort=a.abort;return s}else{throw new Error("Set upload UID first")}};this.get=function(e){if(typeof e=="string"){return r[e]}};this.setUid=function(e){if(typeof e=="string"){n=e;attribute.uid=e}return this};this.save=function(e){e=e||{};if(i["upload"]){var o=new t.File;var u={};var a={};var f=y(e);if(i["tags"]){u.tags=i["tags"]}if(i["ACL"]){u.ACL=i["ACL"]}if(n){a["id"]=n}if(typeof s=="function"){a["onprogress"]=s}o.add("upload",i["upload"],u,a);var l=e.onSuccess;e.onSuccess=function(e,t){if(e.upload){r=e.upload;n=r.uid}i={};if(typeof l=="function"){l(e.upload,t)}};o.upload(e)}else{throw new Error("No upload found")}return f};this.toJSON=function(){return t.Util.clone(r)};this.onProgress=function(e){if(typeof e=="function"){s=e}return this}}})(r);(function(e){var t=e;t.User={};t.User.login=function(e,t,n){n=n||{};if(typeof e!="string"||typeof t!="string"){throw new Error("Email and Password required")}var r=y(options);var i=function(e,t){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&e.application_user){o=e.application_user;h["authtoken"]=e.application_user.authtoken;if(typeof n.onSuccess=="function"){n.onSuccess(e,t)}}else{if(typeof n.onError=="function"){n.onError(e,t)}}};var s={application_user:{email:e,password:t}};var u=b.user.login(h,s,i,{});r._HTTP=u._HTTP;r.abort=u.abort;return r};t.User.loginWithGoogle=function(e,n){if(typeof e=="string"){n=n||{};var r={onError:n.onError,onAlways:n.onAlways,onSuccess:function(e,r){t.User.__setUser__(e);if(typeof n.onSuccess=="function"){n.onSuccess(e,r)}}};var i=y(r);var s=t.User.register({auth_data:{google:{access_token:e}}},r);i._HTTP=s._HTTP;i.abort=s.abort;return i}else{throw new Error("Google Access Token required for login")}return this};t.User.loginWithTibbr=function(e,n,r){if(typeof e=="string"&&typeof n=="string"){r=r||{};var i={onError:r.onError,onAlways:r.onAlways,onSuccess:function(e,n){t.User.__setUser__(e);if(typeof r.onSuccess=="function"){r.onSuccess(e,n)}}};var s=y(i);var o=t.User.register({auth_data:{tibbr:{access_token:e,host:n}}},i);s._HTTP=o._HTTP;s.abort=o.abort;return s}else{throw new Error("Tibbr Access Token and Host required for login")}return this};t.User.loginWithFacebook=function(e,n){if(typeof e=="string"){n=n||{};var r={onError:n.onError,onAlways:n.onAlways,onSuccess:function(e,r){t.User.__setUser__(e);if(typeof n.onSuccess=="function"){n.onSuccess(e,r)}}};var i=y(r);var s=t.User.register({auth_data:{facebook:{access_token:e}}},r);i._HTTP=s._HTTP;i.abort=s.abort;return i}else{throw new Error("Facebook Access Token required for login")}return this};t.User.loginWithTwitter=function(e,n){if(typeof e=="object"&&e.consumer_key&&e.consumer_secret&&e.token&&e.token_secret){n=n||{};var r={onError:n.onError,onAlways:n.onAlways,onSuccess:function(e,r){t.User.__setUser__(e);if(typeof n.onSuccess=="function"){n.onSuccess(e,r)}}};var i=y(r);var s=t.User.register({auth_data:{twitter:{consumer_key:e.consumer_key,consumer_secret:e.consumer_secret,token:e.token,token_secret:e.token_secret}}},r);i._HTTP=s._HTTP;i.abort=s.abort;return i}else{throw new Error("Twitter Consumer key, Consumer Secret, Token, Token Secret required for login")}return this};t.User.saveSession=function(){if(typeof localStorage==="undefined"){throw new Error("Saving Session is not supported in this Client")}if(typeof o=="object"&&typeof localStorage!=="undefined"&&h["application_api_key"]){localStorage.setItem(h["application_api_key"],JSON.stringify(o))}return this};t.User.setSession=function(e){if(typeof e=="object"&&e.authtoken){o=e;for(var t in e){if(t=="authtoken"){h["authtoken"]=e[t]}}}else if(typeof e=="string"){h["authtoken"]=e;o={authtoken:e}}return this};t.User.getSession=function(){if(typeof h["application_api_key"]==="undefined"){throw new Error("First init Built SDK with Built.init(apiKey,appUid)")}try{return JSON.parse(localStorage.getItem(h["application_api_key"]))}catch(e){throw new Error("Storage method is not supported");return}return null};t.User.clearSession=function(){o=null;if(typeof h["authtoken"]!=="undefined"){delete h["authtoken"]}try{localStorage.removeItem(h["application_api_key"])}catch(e){}return this};t.User.logout=function(e){e=e||{};if(o==null||typeof o!="object"||typeof o.authtoken==="undefined"){throw new Error("No user found")}var n=y(e);var r=function(n,r){try{n=JSON.parse(n)}catch(i){}if(typeof n=="object"&&typeof n.notice!=="undefined"){t.User.clearSession();if(typeof e.onSuccess=="function"){e.onSuccess(n,r)}}else{if(typeof e.onError=="function"){e.onError(n,r)}}};var i=b.user.logout(h,{},r,{});n._HTTP=i._HTTP;n.abort=i.abort;return n};t.User.register=function(e,t){e=e||{};t=t||{};if((typeof e.email==="undefined"||typeof e.password==="undefined"||typeof e.password_confirmation==="undefined")&&typeof e.auth_data==="undefined"){throw new Error("Provide required parameters: email, password, password_confirmation OR auth_data");return}var n=y(t);var r=function(e,n){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&typeof e.notice!=="undefined"){if(typeof t.onSuccess=="function"){t.onSuccess(e,n)}}else{if(typeof t.onError=="function"){t.onError(e,n)}}},i={application_user:e};var s=b.user.register(h,i,r,{});n._HTTP=s._HTTP;n.abort=s.abort;return n};t.User.activate=function(e,t,n){if(typeof e=="string"&&typeof t=="string"){n=n={};var r={userId:e,activationToken:t};var i=y(n);var s=function(e,t){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&typeof e.notice!=="undefined"){if(typeof n.onSuccess=="function"){n.onSuccess(e,t)}}else{if(typeof n.onError=="function"){n.onError(e,t)}}};var o=b.user.activate(h,{},s,r);i._HTTP=o._HTTP;i.abort=o.abort;return i}else{throw new Error("UserId and Activation Token required")}};t.User.deactivate=function(e,t){if(typeof h["authtoken"]==="undefined"){throw new Error("Authenticated session required")}else if(typeof e!="string"){throw new Error("User uid required")}t=t||{};var n=y(t);var r=function(e,n){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&typeof e.notice!=="undefined"){o=null;if(h["authtoken"]){delete h["authtoken"]}if(typeof t.onSuccess=="function"){t.onSuccess(e,n)}}else{if(typeof t.onError=="function"){t.onError(e,n)}}};var i=b.user.deactivate(h,{},r,{userId:e});n._HTTP=i._HTTP;n.abort=i.abort;return n};t.User.isAuthenticated=function(){if(o!=null&&typeof o=="object"&&o.authtoken){return true}else{return false}};t.User.currentUser=function(){if(o!=null&&typeof o=="object"&&o["authtoken"]){return o}return null};t.User.refreshUserInfo=function(e){e=e||{};if(typeof h["authtoken"]==="undefined"){throw new Error("No authtoken found");return}var t=y(e);var n=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&t.application_user){var i=o.authtoken||h["authtoken"];o=t;o.authtoken=i;if(typeof e.onSuccess=="function"){e.onSuccess(o,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};var r=b.user.fetchUserInfo(h,{},n,{});t._HTTP=r._HTTP;t.abort=r.abort;return t};t.User.requestResetPassword=function(e,t){t=t||{};if(typeof e!=="string"){throw new Error("Email-id required");return}var n=y(t);var r=function(e,n){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&typeof e.notice!=="undefined"){if(typeof t.onSuccess=="function"){t.onSuccess(e,n)}}else{if(typeof t.onError=="function"){t.onError(e,n)}}};var i={application_user:{email:e}};var s=b.user.forgetPassword(h,i,r,{});n._HTTP=s._HTTP;n.abort=s.abort;return n};t.User.loginWithGoogleNode=function(){return this};var n=function(e,t){var n=y(t);var r=function(e,n){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&e.uid){if(typeof t.onSuccess=="function"){t.onSuccess(e,n)}}else{if(typeof t.onError=="function"){t.onError(e,n)}}};var i=b.user.fetchUidByEmail(h,e,r);n._HTTP=i._HTTP;n.abort=i.abort;return n};t.User.fetchUserUidByEmail=function(e,t){if(typeof e=="string"){var r={application_user:{email:e}};t=t||{};return n(r,t)}else{throw new Error("Email id required")}};t.User.fetchUserUidByGoogleEmail=function(e,t){if(typeof e=="string"){var r={application_user:{auth_data:{google:{email:e}}}};t=t||{};return n(r,t)}else{throw new Error("Google Email id required")}};t.User.fetchUserUidByFacebookUserId=function(e,t){if(typeof e=="string"){var r={application_user:{auth_data:{facebook:{user_id:e}}}};t=t||{};return n(r,t)}else{throw new Error("Facebook UserId required")}};t.User.fetchUserUidByTibbrUserId=function(e,t,r){if(typeof e=="string"&&typeof t=="string"){var i={application_user:{auth_data:{tibbr:{user_id:e,host:t}}}};r=r||{};return n(i,r)}else{throw new Error("Tibbr UserId and Host required")}return this};t.User.__setUser__=function(e){try{e=JSON.parse(e)}catch(t){}if(typeof e=="object"&&e.notice&&typeof e.application_user=="object"&&e.application_user.authtoken){o=e.application_user;h["authtoken"]=e.application_user.authtoken;return true}return false}})(r);(function(e){var t=e;t.Delta=function(e){if(typeof e!="string"){throw new Error("Built Class UID required for Delta object")}var n={delta:{}};var r=e;this.createdAt=function(e){if(typeof r!="string"){throw new Error("Class UID required")}if(typeof e!="string"){throw new Error("Time required to query delta objects")}n.delta["created_at"]=e;return this};this.deletedAt=function(e){if(typeof r!="string"){throw new Error("Class UID required")}if(typeof e!="string"){throw new Error("Time required to query delta objects")}n.delta["deleted_at"]=e;return this};this.updatedAt=function(e){if(typeof r!="string"){throw new Error("Class UID required")}if(typeof e!="string"){throw new Error("Time required to query delta objects")}n.delta["updated_at"]=e;return this};this.allDeltaAt=function(e){if(typeof r!="string"){throw new Error("Class UID required")}if(typeof e!="string"){throw new Error("Time required to query delta objects")}n.delta["ALL"]=e;return this};this.exec=function(e){e=e||{};var i=this;if(typeof r!="string"){throw new Error("Class UID required")}if(t.Util.dataType(n)!="object"||m(n)==true){throw new Error("No Delta query found to execute");return}var s=new t.Query(r);var o={};o.query=n;o.model=false;o.onSuccess=function(t,n){if(e.model===false){if(typeof e.onSuccess=="function"){e.onSuccess(t,n)}}else{if(typeof t.objects.created_at!=="undefined"){t.objects.created_at=s.__toObjectModel__(t.objects.created_at,r)}if(typeof t.objects.updated_at!=="undefined"){t.objects.updated_at=s.__toObjectModel__(t.objects.updated_at,r)}if(typeof t.objects.deleted_at!=="undefined"){t.objects.deleted_at=s.__toObjectModel__(t.objects.deleted_at,r)}if(typeof e.onSuccess=="function"){e.onSuccess(t.objects,n)}}};o.onError=e.onError;o.onAlways=e.onAlways;return s.exec(o)}}})(r);(function(e){var n=e;n.Object=function(e,r){if(typeof r==="string"&&r!=""){this.class_uid=r}if(typeof this.class_uid!="string"){throw new Error("Class UID required")}var i=null;var s={};var o=null;var u={};var a={};var f={};var l={};if(typeof e=="string"&&e!=""){e={uid:e}}if(n.Util.dataType(e)=="object"&&e.uid){o=e.uid;s=n.Util.clone(e)}this.initialize=function(){};this.setTags=function(e){var t=e;if(n.Util.dataType(e)==="array"){t=t.join(",")}if(t.indexOf(" ")>=0){t=t.split(" ").join(",")}a["tags"]=t;return this};this.timeless=function(){l["timeless"]=true};this.upsert=function(e,t){if(typeof e==="string"&&t){if(typeof f["UPSERT"]==="undefined"){f["UPSERT"]={}}f["UPSERT"][e]=t}else if(n.Util.datatype(e)=="object"){if(typeof f["UPSERT"]==="undefined"){f["UPSERT"]={}}f["UPSERT"]=n.Util.mix(f["UPSERT"],e)}};this.upsertForReference=function(e,t){if(typeof e=="string"&&n.Util.dataType(t)=="object"){if(typeof a[e]==="undefined"){a[e]={}}a[e]["UPSERT"]=t}return this};this.increment=function(e,t){if(typeof e=="string"&&e!=""){t=isNaN(t)==true?1:t;this.set(e,{ADD:t})}return this};this.decrement=function(e,t){if(typeof e=="string"&&e!=""){t=isNaN(t)==true?1:t;this.set(e,{SUB:t})}return this};this.multiply=function(e,t){if(typeof e=="string"&&e!=""){t=isNaN(t)==true?1:t;this.set(e,{MUL:t})}return this};this.divide=function(e,t){if(typeof e=="string"&&e!=""){t=isNaN(t)==true?1:t;this.set(e,{DIV:t})}return this};this.pushValue=function(e,t,r){if(typeof arguments[0]==="string"&&arguments[0]!=""){var i={PUSH:{}};var s=Array.prototype.slice.apply(arguments,[1,arguments.length]);for(var o=0,u=s.length;o<u;o++){var f=typeof s[o];if(f=="object"){if(typeof i["PUSH"]["data"]==="undefined"){i["PUSH"]["data"]=[]}i["PUSH"]["data"].push.apply(i["PUSH"]["data"],s[o])}else if(f=="number"){i["PUSH"]["index"]=s[o]}else if(f=="string"){if(typeof i["PUSH"]["data"]==="undefined"){i["PUSH"]["data"]=[]}i["PUSH"]["data"].push(s[o])}}if(typeof i["PUSH"]["data"]!=="undefined"||i["PUSH"]["index"]!=="undefined"){if(typeof a[e]==="undefined"){a[e]={}}a[e]=n.Util.mix(a[e],i)}}return this};this.pullValue=function(e,t){if(typeof e==="string"&&e!=""&&t){if(typeof a[e]==="undefined"){a[e]={}}if(typeof a[e]["PULL"]==="undefined"){a[e]["PULL"]={}}if(typeof a[e]["PULL"]["data"]==="undefined"){a[e]["PULL"]["data"]=[]}if(n.Util.dataType(t)=="array"){a[e]["PULL"]["data"]=a[e]["PULL"]["data"].concat(t)}else{a[e]["PULL"]["data"].push(t)}}return this};this.pullValueAtIndex=function(e,t){if(typeof e==="string"&&isNaN(t)==false){if(typeof a[e]==="undefined"){a[e]={}}if(typeof a[e]["PULL"]==="undefined"){a[e]["PULL"]={}}a[e]["PULL"]["index"]=parseInt(t)}return this};this.set=function(e,t){if(typeof e=="object"){a=n.Util.mix(a,e)}else if(typeof e=="string"&&t){a[e]=t}return this};this.setReferenceWhere=function(e,t){if(typeof e=="string"&&t){a[e]={WHERE:t}}return this};this.setReference=function(e,t){if(typeof e=="string"&&t){if(n.Util.dataType(a[e])!="array"){a[e]=[]}if(n.Util.dataType(t)=="array"){a[e]=a[e].concat(t)}else{a[e].push(t)}}return this};this.setLocation=function(e){if(e instanceof n.Location){var t=e.toJSON();this.set("__loc",[t.longitude,t.latitude])}else{throw new Error("Built.Location object required")}return this};this.updateValue=function(e,t,n){if(typeof e=="string"&&isNan(n)==false&&t){a[e]={UPDATE:{data:t,index:n}}}return this};this.fetch=function(e){if(typeof this.class_uid!=="string"||this.class_uid.length<=0||typeof o!=="string"||o.length<=0){throw new Error("Object Uid and Class Uid required");return}e=e||{};var t,n=this,r={};var i=y(e);var f=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&typeof t.object!=="undefined"){s=t.object;o=t.object.uid;a={};if(typeof e.onSuccess=="function"){e.onSuccess(t.object,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};r.class_uid=this.class_uid;if(o){r.object_uid=o}var l=b.object.fetch(h,u,f,r);i._HTTP=l._HTTP;i.abort=l.abort;return i};this.saveAsDraft=function(e){this.set({published:false});return this.save(e)};this.includeFilter=function(e,t){if(typeof e=="string"&&t){u[e]=t}return this};this.setACL=function(e){if(typeof e=="object"&&typeof e.toJSON=="function"){var t=e.toJSON();if(t.others&&t.roles&&t.users){this.set("ACL",t)}}return this};this.save=function(e){e=e||{};var t=this,r={};var i=y(e);var u=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&typeof t.object!=="undefined"){s=t.object;o=t.object.uid;a={};if(typeof e.onSuccess=="function"){e.onSuccess(t.object,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};r.class_uid=this.class_uid;if(o){r.object_uid=o}if(m(a)==false){if(typeof o=="string"&&o.length>0){var c=b.object.update(h,{object:a},u,r);i._HTTP=c._HTTP;i.abort=c.abort;return i}else{var p=n.Util.mix({object:a},f);var d=n.Util.mix(l,h);var c=b.object.create(d,p,u,r);i._HTTP=c._HTTP;i.abort=c.abort;return i}}else{throw new Error("No Attribute found to save or update")}return this};this.destroy=function(e){e=e||{};var t=this,n={};var r=y(e);var i=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&typeof t.notice!=="undefined"){o=null;s={};a={};if(typeof e.onSuccess=="function"){e.onSuccess(t,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};n.class_uid=this.class_uid;if(o){n.object_uid=o;var u=b.object.destroy(h,{},i,n);r._HTTP=u._HTTP;r.abort=u.abort;return r}else{throw new Error("No Object uid found")}return this};this.getSchema=function(e){e=e||{};var t=y(e);var n=c(e,this);t._HTTP=n._HTTP;t.abort=n.abort;return t};var c=function(e,t){if(n.Util.dataType(i)=="array"){if(typeof e.onSuccess=="function"){e.onSuccess(i)}}var r={},s=e.onSuccess,o=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&t["class"]){i=t["class"].schema;if(typeof s=="function"){s(t["class"].schema,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};e.onSuccess=o;r.class_uid=t.class_uid;return b["class"].fetch(h,{},o,r)};this.has=function(e){return hasOwnProperty.call(s,e)};this.get=function(e){if(e){return s[e]}else{return t}};this.setUid=function(e){if(typeof e=="string"){o=e}return this};this.clone=function(){return new this.constructor(s)};this.isNew=function(){return!o};this.toJSON=function(){return n.Util.clone(s)};this.initialize.apply(this,arguments)};n.Object.extend=function(e){if(typeof e=="string"){e={class_uid:e};return g.call(n.Object,e)}return g.apply(n.Object,arguments)}})(r);(function(e){var t=e;t.ACL=function(e){var n={others:{},users:[],roles:[]},r=this;if(e!=="undefined"){if(t.Util.dataType(e)!="object"){try{e=JSON.parse(e)}catch(i){}}if(t.Util.dataType(e)=="object"){if(e.others){n.others=e.others}if(e.users){n.users=e.users}if(e.roles){n.roles=e.roles}}else{}}this.__getAccess=function(e,t,r){if(typeof e==="undefined"||typeof t==="undefined"||typeof r==="undefined"){return}var i=n[e];for(var s=0,o=i.length;s<o;s++){if(i[s].uid&&i[s].uid==r&&i[s][t]&&i[s][t]==true){return true}}return false};this.__setAccess=function(e,i,s,o){if(typeof e==="undefined"||typeof i==="undefined"||typeof s==="undefined"||typeof o==="undefined"){return}if(t.Util.dataType(o)=="boolean"&&s){var u=n[e];for(var a=0,f=u.length;a<f;a++){if(u[a].uid&&u[a].uid==s){u[a][i]=o;return}}var l={};l.uid=s;l[i]=o;n[e].push(l)}return r};this.__getd=function(){t.Util.clone(n)}};t.Util.extend(t.ACL.prototype,{getPublicReadAccess:function(){if(acl.others.read){return true}return false},getPublicWriteAccess:function(){if(acl.others.update){return true}return false},getPublicDeleteAccess:function(){if(acl.others["delete"]){return true}return false},getUserReadAccess:function(e){return this.__getAccess("users","read",e)},getUserWriteAccess:function(e){return this.__getAccess("users","update",e)},getUserDeleteAccess:function(e){return this.__getAccess("users","delete",e)},getRoleReadAccess:function(e){return this.__getAccess("roles","read",e)},getRoleWriteAccess:function(e){return this.__getAccess("roles","update",e)},getRoleDeleteAccess:function(e){return this.__getAccess("roles","delete",e)},setPublicReadAccess:function(e){if(t.Util.dataType(e)=="boolean"){acl.others.read=true}return this},setPublicWriteAccess:function(e){if(t.Util.dataType(e)=="boolean"){acl.others.update=true}return this},setPublicDeleteAccess:function(e){if(t.Util.dataType(e)=="boolean"){acl.others["delete"]=true}return this},setUserReadAccess:function(e,t){return this.__setAccess("users","read",e,t)},setUserWriteAccess:function(e,t){return this.__setAccess("users","update",e,t)},setUserDeleteAccess:function(e,t){return this.__setAccess("users","delete",e,t)},setRoleReadAccess:function(e,t){return this.__setAccess("roles","read",e,t)},setRoleWriteAccess:function(e,t){return this.__setAccess("roles","update",e,t)},setRoleDeleteAccess:function(e,t){return this.__setAccess("roles","delete",e,t)},toJSON:function(){return this.__getd()}})})(r);(function(e){var n=e;n.Query=function(e){if(typeof e!="string"){throw new Error("Class UID required")}var r=e;var o=null;var u=this,a=false;var f={};var l=[];var c=[];var p=null;var d=[];var v={};var m=function(e,t,n,r){if(r){if(typeof f[r]==="undefined"){f[r]={}}if(typeof f[r][e]==="undefined"){f[r][e]={}}f[r][e][t]=n}return this};var g=function(e,t){if(typeof e=="object"){if(typeof e[t]!="object"){e[t]={}}}};var w=function(e){if(e&&e!=null&&typeof e=="object"){p=e;return p}else{if(typeof p==="object"&&p!=null&&p!=t&&p!=""){return p}return E()}};var E=function(){var e=f["query"]||null;var t=n.Util.clone(f);var r=false;if(l.length>0){t["query"]={};for(var i=0;i<l.length;i++){if(typeof t["query"]["$or"]!="object"){t["query"]["$or"]=[]}if(typeof l[i]!=="undefined"&&typeof l[i]["query"]=="object"){t["query"]["$or"].push(l[i]["query"])}}if(e!=null){t["query"]["$or"].push(e)}}if(c.length>0){if(l.length<1){t["query"]={}}for(var i=0;i<c.length;i++){if(typeof t["query"]["$and"]!="object"){t["query"]["$and"]=[]}if(typeof c[i]!=="undefined"&&typeof c[i]["query"]=="object"){t["query"]["$and"].push(c[i]["query"])}}if(e!=null){t["query"]["$and"].push(e)}}return t};this.__toObjectModel__=function(e,t){t=r||t;if(!t){throw new Error("Class UID required")}var i=n.Object.extend(t),s=[],o;if(n.Util.dataType(e)=="array"){for(var u=0,a=e.length;u<a;u++){if(typeof e[u]=="object"&&e[u].uid&&typeof e[u].uid=="string"){s[s.length]=new i(e[u])}}return s}else if(n.Util.dataType(e)=="object"){if(typeof e=="object"&&e.uid&&typeof e.uid=="string"){o=new i(e);return o}return null}else{return null}};this.Cache={onlyNetwork:function(){o="only_network";return u},onlyCache:function(){o="only_cache";return u},cacheElseNetwork:function(){o="cache_else_network";return u},networkElseCache:function(){o="network_else_cache";return u},cacheThenNetwork:function(){o="cache_then_network";return u}};var S=function(e,t,n,r){var i=_.encode(t);var s=D.get(i);if(s){try{s=JSON.parse(s);if(typeof e.model!=="undefined"&&e.model==false){if(typeof e.onSuccess=="function"){e.onSuccess(s,null)}}else{var o=typeof s.objects!=="undefined"?s.objects:typeof s.object!=="undefined"?s.object:s;if(typeof e.onSuccess=="function"){e.onSuccess(n.__toObjectModel__(o,n.class_uid),null)}}return{abort:function(){}}}catch(u){if(typeof e.onError=="function"){return e.onError({error_message:"no cache found"},null)}}}else{if(typeof e.onError=="function"){return e.onError({error_message:"no cache found"},null)}}if(typeof r==="function"){r()}};this.getClassUid=function(){return r};this.exec=function(e){if(typeof r!="string"){throw new Error("Class UID required")}e=e||{};var t=this,n={},i=e.query||w(),u=o?o:s;n.class_uid=e.class_uid||r;var a=JSON.stringify(h)+n.class_uid+JSON.stringify(i);try{i=JSON.parse(i)}catch(f){}var l=y(e);var c=function(n,r){try{n=JSON.parse(n)}catch(i){}if(typeof n=="object"&&typeof n.objects!=="undefined"){if(u&&u!="only_network"){D.set(_.encode(a),JSON.stringify(n))}if(typeof e.model!=="undefined"&&e.model==false){if(typeof e.onSuccess=="function"){e.onSuccess(n,r)}}else{var s;if(n.schema){s={schema:n.schema,objects:t.__toObjectModel__(n.objects)}}if(n.count){s=s||{};s.count=n.count;if(typeof s.objects==="undefined"){s.objects=t.__toObjectModel__(n.objects)}}if(typeof s!="object"||typeof s.objects!="object"){s=t.__toObjectModel__(n.objects)}if(typeof e.onSuccess=="function"){e.onSuccess(s,r)}}}else{if(typeof e.onError=="function"){e.onError(n,r)}}};var p=function(){return b.object.fetch(h,i,c,n)};var d=e.onError||function(){};e.onError=d;if(u==="only_cache"){var v=S(e,a,t);l._HTTP=v._HTTP;l.abort=v.abort;return l}else if(u==="cache_else_network"){e.onError=function(){e.onError=d;return p()};var v=S(e,a,t);l._HTTP=v._HTTP;l.abort=v.abort;return l}else if(u==="network_else_cache"){var d=e.onError;e.onError=function(){e.onError=d;return S(e,a,t)};var v=p();l._HTTP=v._HTTP;l.abort=v.abort;return l}else if(u==="cache_then_network"){var v=S(e,a,t,p);l._HTTP=v._HTTP;l.abort=v.abort;return l}else{var v=p();l._HTTP=v._HTTP;l.abort=v.abort;return l}};this.notInQuery=function(e,t){if(e&&t){var r,i={},s,o,u;if(t instanceof n.Query&&typeof t.toJSON==="function"){u=t.toJSON().query}else{u=t}if(e.indexOf(">")>=0){r=e.split(">");o=r[0];_count=e.length-1;for(var a=r.length;a>0;a--){if(r[a-1]!=""){s=i;i={};i[r[a-1]]={$nin_query:a==r.length?u:s}}}}else{i[e]={$nin_query:u}}if(typeof f["query"]!="object"){f["query"]={}}f["query"]=n.Util.mix(f["query"],i)}return this};this.inQuery=function(e,t){if(e&&t){var r,i={},s,o,u;if(t instanceof n.Query&&typeof t.toJSON==="function"){u=t.toJSON().query}else{u=t}if(e.indexOf(">")>=0){r=e.split(">");o=r[0];_count=e.length-1;for(var a=r.length;a>0;a--){if(r[a-1]!=""){s=i;i={};i[r[a-1]]={$in_query:a==r.length?u:s}}}}else{i[e]={$in_query:u}}if(typeof f["query"]!="object"){f["query"]={}}f["query"]=n.Util.mix(f["query"],i)}return this};this.tags=function(){f["tags"]=f["tags"]||[];for(i=0;i<arguments.length;i++){if(typeof arguments[i]=="string"){f["tags"]=f["tags"].concat(arguments[i].split(/[\s,]+/))}else if(n.Util.dataType(arguments[i])=="array"){f["tags"]=f["tags"].concat(arguments[i])}}return this};this.where=function(e,t){if(typeof f["query"]!="object"){f["query"]={}}f["query"][e]=t;return this};this.skip=function(e){if(n.Util.dataType(e)=="number"&&parseInt(e)>=0){f["skip"]=e}return this};this.limit=function(e){if(n.Util.dataType(e)=="number"&&parseInt(e)>0){f["limit"]=e}return this};this.includeSchema=function(){f["include_schema"]=true;return this};this.includeCount=function(){f["include_count"]=true;return this};this.includeOwner=function(){f["include_owner"]=true;return this};this.beforeUid=function(e){if(n.Util.dataType(e)=="string"){f["before_uid"]=e}return this};this.afterUid=function(e){if(n.Util.dataType(e)=="string"){f["after_uid"]=e}return this};this.includeDrafts=function(){f["include_unpublished"]=true;return this};this.onlyDrafts=function(){this.includeDrafts();if(typeof f["query"]!="object"){f["query"]={}}f.query["published"]=false;return this};this.notEqualTo=function(e,t){m(e,"$ne",t,"query");return this};this.lessThan=function(e,t){m(e,"$lt",t,"query");return this};this.greaterThan=function(e,t){m(e,"$gt",t,"query");return this};this.lessThanOrEqualTo=function(e,t){m(e,"$lte",t,"query");return this};this.greaterThanOrEqualTo=function(e,t){m(e,"$gte",t,"query");return this};this.containedIn=function(e,t){if(typeof t!="object"){t=[t]}m(e,"$in",t,"query");return this};this.notContainedIn=function(e,t){if(typeof t!="object"){t=[t]}m(e,"$nin",t,"query");return this};this.exists=function(e){m(e,"$exists",true,"query");return this};this.doesNotExist=function(e){m(e,"$exists",false,"query");return this};this.matches=function(e,t,n){if(typeof f["query"]==="undefined"){f["query"]={}}if(typeof f["query"][e]==="undefined"){f["query"][e]={}}f["query"][e]["$regex"]=t;if(n){f["query"][e]["$options"]=n}return this};this.include=function(e){if(n.Util.dataType(f["include"])!="array"){f["include"]=[]}if(n.Util.dataType(e)=="array"){for(var t=0,r=e.length;t<r;t++){f["include"].push(e[t])}}else{f["include"].push(e)}return this};this.only=function(e,t){if(typeof f["only"]!=="object"){f["only"]={}}if(typeof t==="string"){if(typeof f["only"][t]!=="object"){f["only"][t]=[]}if(n.Util.dataType(e)=="array"){f["only"][t]=f["only"][t].concat(e)}else{f["only"][t].push(e)}}else{if(typeof f["only"]["BASE"]!=="object"){f["only"]["BASE"]=[]}f["only"]["BASE"].push(e)}return this};this.except=function(e,t){if(typeof f["except"]!=="object"){f["except"]={}}if(typeof t==="string"){if(typeof f["except"][t]!=="object"){f["except"][t]=[]}if(n.Util.dataType(e)=="array"){f["except"][t]=f["except"][t].concat(e)}else{f["except"][t].push(e)}}else{if(typeof f["except"]["BASE"]!=="object"){f["except"]["BASE"]=[]}f["except"]["BASE"].push(e)}return this};this.includeFilter=function(e,t){if(typeof e=="string"&&t){f[e]=t}return this};this.ascending=function(e){if(typeof e=="string"){f["asc"]=e}return this};this.descending=function(e){if(typeof e=="string"){f["desc"]=e}return this};this.and=function(e){for(var t=0,r=arguments.length;t<r;t++){if(arguments[t]instanceof n.Query&&typeof arguments[t]["toJSON"]==="function"){c.push(arguments[t]["toJSON"]())}}return this};this.or=function(e){for(var t=0,r=arguments.length;t<r;t++){if(arguments[t]instanceof n.Query&&typeof arguments[t]["toJSON"]==="function"){l.push(arguments[t]["toJSON"]())}}return this};this.select=function(e,t,r){if(t instanceof n.Query&&typeof t["toJSON"]==="function"&&t.getClassUid()!=""&&t.getClassUid()!=="undefined"&&typeof r==="string"&&r!=""&&typeof e==="string"&&e!=""){if(typeof f["query"]!="object"){f["query"]={}}f["query"][key]={$select:{query:t.toJSON().query},class_uid:t.getClassUid(),key:r}}else{throw new Error("incorrect parameter")}return this};this.dontSelect=function(e,t,r){if(t instanceof n.Query&&typeof t["toJSON"]==="function"&&t.getClassUid()!=""&&t.getClassUid()!=="undefined"&&typeof r==="string"&&r!=""&&typeof e==="string"&&e!=""){if(typeof f["query"]!="object"){f["query"]={}}f["query"][key]={$dont_select:{query:t.toJSON().query},class_uid:t.getClassUid(),key:r}}else{throw new Error("incorrect parameter")}return this};this.nearLocation=function(e,t){t=t||1e3;g(f,"query");if(e instanceof n.Location&&typeof t=="number"){var r=e.toJSON();f["query"]["$near"]={coords:[r.longitude,r.latitude],radius:t}}else if(typeof e=="string"&&typeof t=="number"){f["query"]["$near"]={coords:[r.longitude,r.latitude],radius:t}}else{throw new Error("Invalid parameter")}return this};this.withInLocation=function(e){g(f,"query");if(n.Util.dataType(e)=="array"){if(e.length<3){throw new Error("Minimum 3 Locations or ObjectUid required")}var t=[];for(var r=0;r<e.length;r++){if(e[r]instanceof n.Location){var i=e[r].toJSON();t.push([i.longitude,i.latitude])}else if(typeof e[r]=="string"){t.push({object:e[r]})}else{throw new Error("Invalid parameter: "+i[r])}}f["query"]["$within"]=t}return this};this.toJSON=function(e){return w(e)};this.count=function(e){e=e||{};var t=y(e);if(typeof r=="string"&&r.length>0){var n,i=this,s={};var o=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&typeof t.objects!=="undefined"){if(typeof e.onSuccess=="function"){e.onSuccess(t.objects,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};s.class_uid=r;var u=opt=w()||{};u.count=true;var a=b.object.fetch(h,u,o,s);t._HTTP=a._HTTP;t.abort=a.abort;return t}else{if(typeof e=="object"&&typeof e.onError=="function"){e.onError({error_message:"incomplete parameters"})}throw new Error("Incomplete parameters")}return this}}})(r);(function(e){var t=e;t.Location=function(e){var n={longitude:0,latitude:0};var r=function(e,t){if(typeof e!="number"||typeof t!="number"){throw new Error("Invalid Data Types")}if(t<-90||t>90){throw new Error("Invalid latitude: "+t)}if(e<-180||e>180){throw new Error("Invalid longitude: "+e)}};if(t.Util.dataType(e)=="object"){if(e.longitude&&e.longitude){r(e.longitude,e.longitude);n.longitude=e.longitude;n.latitude=e.latitude}}else if(t.Util.dataType(e)=="array"){if(e.length>=2){r(e[0],e[1]);n.longitude=e[0];n.latitude=e[1]}}else if(arguments.length>=2){r(arguments[0],arguments[1]);n.longitude=arguments[0];n.latitude=arguments[1]}this.getRadians=function(e){if(e instanceof t.Location){var r=e.toJSON();var i=Math.PI/180,s=n.latitude*i,o=n.longitude*i,u=r.latitude*i,a=r.longitude*i,f=s-u,l=o-a,c=Math.sin(f/2),h=Math.sin(l/2);var p=c*c+Math.cos(s)*Math.cos(u)*h*h;p=Math.min(1,p);return 2*Math.asin(Math.sqrt(p))}else{throw new Error("Built.Location object required")}};this.setLocation=function(e,t){if(typeof e=="number"&&typeof t=="number"){r(e,t);n.longitude=e;n.latitude=t}return this};this.kilometersFrom=function(e){return this.getRadians(e)*6371},this.milesFrom=function(e){return this.getRadians(e)*3958.8};this.toJSON=function(){return{longitude:n.longitude,latitude:n.latitude}}};t.Location.getCurrentLocation=function(e){e=e||{};var n=y(e);if(typeof navigator!=="undefined"&&typeof navigator.geolocation!=="undefined"){navigator.geolocation.getCurrentPosition(function(n){if(typeof e.onSuccess=="function"){e.onSuccess(new t.Location({latitude:n.coords.latitude,longitude:n.coords.longitude}))}},function(t){if(typeof e.onError=="function"){e.onError({error_message:t.message,code:t.code,object:t})}})}else{if(typeof e.onError=="function"){e.onError({error_message:"Platform not supported Geo functionality"})}}return n}})(r);(function(e){var t=e;t.Role=function(){this.__roles=[];this.fetchRoles=function(e){var r=n.Base+"/"+n.classes+"/"+n.role;var i=this;r=v(r);var s=new t.Query("built_io_application_user_role");s.includeUser();return s.exec({model:false,onSuccess:function(t,n){try{t=JSON.parse(t)}catch(r){}i.__roles=t.objects||[];if(typeof e.onSuccess=="function"){e.onSuccess(t.objects,n)}},onError:e.onError,onAlways:e.onAlways})};this.create=function(e){if(typeof e!="string"){throw new Error("RoleName required")}var t={name:e,roles:[],users:[]};return new this.Object(t)};this.get=function(e){if(typeof e!="string"){throw new Error("RoleName required")}var n=this;for(var r=0;r<n.__roles.length;r++){var i=n.__roles[r];if(typeof i=="object"&&i.name==e){return new t.Role.Object(i)}}return null};this.has=function(e){if(typeof e!="string"){throw new Error("RoleName required")}var t=this;for(var n=0;n<t.__roles.length;n++){var r=t.__roles[n];if(typeof r=="object"&&r.name==e){return true}}return false};this.count=function(){return this.__roles.length};this.Object=function(e){var t={};if(typeof e!=="object"||typeof e.name==="undefined"||typeof e.roles==="undefined"||typeof e.users==="undefined"){throw new Error("Incorrect Object")}t=e;this.addUser=function(e){if(typeof e=="object"){if(e.uid){t.push(e.uid)}}else if(typeof e=="string"){t.push(e)}return this};this.removeUser=function(e){var n;if(typeof e=="object"){if(e.uid){n=e.uid}}else if(typeof e=="string"){n=e}if(n){for(var r=0;r<t.users.length;r++){if(e.uid==t.users[r]){t.users.splice(r,1)}}}return this};this.addRole=function(e){var n;if(typeof e=="object"){if(e.uid){n=e.uid}}else if(typeof user=="string"){n=e}if(n){for(var r=0;r<t.roles.length;r++){if(e.uid==t.roles[r]){return}}t.roles.push(n)}return this};this.removeRole=function(e){var n;if(typeof e=="object"){if(e.uid){n=e.uid}}else if(typeof user=="string"){n=e}if(n){for(var r=0;r<t.roles.length;r++){if(e.uid==t.roles[r]){t.roles.splice(r,1)}}}return this};this.hasUser=function(e){if(e&&t.users.indexOf(e)>=0){return true}return false};this.hasRole=function(e){if(user_uid&&t.roles.indexOf(e)>=0){return true}return false};this.getUsers=function(){return t.users};this.getRoles=function(){return t.roles};this.destroy=function(e){if(typeof t!=="object"||t.uid==="undefined"){throw new Error("role not found")}var r=n.Base+"/"+n.role;r=v(r);e=e||{};var i=this,s={};var o=y(e);var u=function(e,n){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&typeof e.notice!=="undefined"){if(typeof callback.onSuccess=="function"){callback.onSuccess(e,n);t.uid=null;t.users=[];t.roles=[]}}else{if(typeof callback.onError=="function"){callback.onError(e,n)}}};s.class_uid="built_io_application_user_role";if(t.object_uid){s.object_uid=t.uid;var a=b.object.destroy(h,{},u,s);o._HTTP=a._HTTP;o.abort=a.abort;return o}else{if(typeof callback.onError=="function"){callback.onError({error_message:"Object uid not not found"})}throw new Error("Object uid not not found")}};this.save=function(e){if(typeof t!=="object"||t.roles==="undefined"||t.users==="undefined"){throw new Error("role not found")}e=e||{};var n=this,r={};var i=y(e);var s=function(e,n){try{e=JSON.parse(e)}catch(r){}if(typeof e=="object"&&typeof e.object!=="undefined"){t=e.object;if(typeof callback.onSuccess=="function"){callback.onSuccess(e.object,n)}}else{if(typeof callback.onError=="function"){callback.onError(e,n)}}};r.class_uid="built_io_application_user_role";if(t.uid){r.object_uid=t.uid}if(typeof t.uid=="string"&&t.uid.length>0){var o=b.object.update(h,{object:{roles:t.roles,users:t.users}},s,r);i._HTTP=o._HTTP;i.abort=o.abort;return i}else{var o=b.object.create(h,{object:t},s,r);i._HTTP=o._HTTP;i.abort=o.abort;return i}return this}}}})(r);(function(e){var t=e;t.Promise=function(){var e=[],t=[],n=[],r=false,i=false,s=[];this.done=function(t,n){if(typeof t=="function"){n=n||this;if(i){t.apply(n,s);return this}e.push({callback:t,context:n})}return this};this.fail=function(e,n){if(typeof e=="function"){n=n||this;if(r){e.apply(n,s);return this}t.push({callback:e,context:n})}return this};this.always=function(e,t){if(typeof e=="function"){t=t||this;if(r){e.apply(t,s);return this}else if(i){e.apply(t,s);return this}n.push({callback:e,context:t})}return this};this.resolve=function(){s=Array.prototype.slice.call(arguments);for(var t=0,n=e.length;t<n;t++){var r=e[t];if(r){r.callback.apply(r.context,s)}}e=[];o();i=true;return this};this.reject=function(){s=Array.prototype.slice.call(arguments);for(var e=0,n=t.length;e<n;e++){var i=t[e];if(i){i.callback.apply(i.context,s)}}t=[];o();r=true;return this};var o=function(){for(var e=0,t=n.length;e<t;e++){var r=n[e];if(r){r.callback.apply(r.context,s)}}n=[]}}})(r);(function(e){var t=e;t.Application={};t.Application.getSettings=function(e){e=e||{};var t=y(e);var n=function(t,n){try{t=JSON.parse(t)}catch(r){}if(typeof t=="object"&&typeof t.application!=="undefined"){if(typeof e.onSuccess=="function"){e.onSuccess(t,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};var r=b.app_setting.fetch(h,{include_application_variables:true},n);t._HTTP=r._HTTP;t.abort=r.abort;return t};t.Application.users=function(){return new t.Query("built_io_application_user")}})(r);(function(e){var t=e;t.Cloud={};t.Cloud.execute=function(e,t,r){var i=h["application_api_key"];if(typeof i=="string"&&i!=""&&typeof e=="string"&&typeof r=="object"){t=t||{};if(t==null||typeof t!="object"){t={}}var s=v(n.cloudCodeRun+e);var o={api_key:i};var u=y(r);var a=function(e,t){if(t.status==200){if(typeof r.onSuccess=="function"){r.onSuccess(e,t)}}else if(typeof r.onError=="function"){r.onError(e,t)}};var f=w(s,o,t,a);u._HTTP=f._HTTP;u.abort=f.abort;return u}else{throw new Error("Incomplete parameters")}};t.Cloud.define=function(e,t){if(l==false){throw new Error("This functionality is only for NodeJS")}return this};t.Cloud.beforeSave=function(e,t){if(l==false){throw new Error("This functionality is only for NodeJS")}return this};t.Cloud.afterSave=function(e,t){if(l==false){throw new Error("This functionality is only for NodeJS")}return this};t.Cloud.http=function(){if(l==false){throw new Error("This functionality is only for NodeJS")}return this}})(r);(function(e){var t=e;t.Analytics={};t.Analytics.Event=function(e){var n=e||"";var r=[];var i={};this.addAttributes=function(e,t,n){if(typeof e=="object"){var i={properties:e};if(typeof t=="string"){i["previous_event_uid"]=t}if(n instanceof Date&&typeof n.toISOString=="function"){i["created_at"]=n.toISOString()}r.push(i);return this}throw new Error("Object required")};this.setUid=function(e){if(typeof e=="string"){n=e}return this};this.trigger=function(e){if(n!=""){e=e||{};var t=this.toJSON();var s=y(e);var o=function(t,n){try{t=JSON.parse(t)}catch(s){}if(typeof t.notice!=="undefined"){r=[];i={};if(typeof e.onSuccess=="function"){e.onSuccess(t,n)}}else{if(typeof e.onError=="function"){e.onError(t,n)}}};var u=b.as.trigger(h,t,o);s._HTTP=u._HTTP;s.abort=u.abort;return s}throw new Error("Event UID required, use setUid method to set event uid")};this.appendEvent=function(e){if(e instanceof t.Analytics.Event&&typeof e.toJSON=="function"){var n=e.toJSON();if(n.events){for(var r in n.events){i[r]=n.events[r]}}}else{throw new Error("Built.Analytics.Event Object instance required")}return this};this.toJSON=function(){if(n!=""){var e={};e[n]=r;e=t.Util.mix(e,i);return{events:e}}return null}}})(r);(function(e){var t=e;t.Notification=function(){var e={msg:"",time:"",users:[],local:false};this.message=function(t){if(typeof t=="string"){e.msg=t}else{throw new Error("Invalid Message type")}return this};this.atTime=function(t){if(t instanceof Date){e.time=t.toISOString()}else{throw new Error("JavaScript Date Object required")}return this};this.addUsers=function(n){if(typeof n=="string"){e.users.push(n)}else if(t.Util.dataType(n)=="array"){e.users=e.users.concat(n)}return this};this.inLocalTime=function(t){if(typeof t=="boolean"){e.local=t}};this.send=function(t){if(e.msg!=""&&e.users.length>0){t=t||{};var n=y(t);var r={push:{message:e.msg}};if(e.time!=""){r.push.send_at=e.time;r.push.local_push=e.local}if(e.users.length>0){r.push.user_uids=e.users}var i=function(n,r){try{n=JSON.parse(n)}catch(i){}if(typeof n.notice!=="undefined"){e.time="";e.msg="";e.local=false;e.users=[];if(typeof t.onSuccess=="function"){t.onSuccess(n,r)}}else{if(typeof t.onError=="function"){t.onError(n,r)}}};var s=b.notification.send(h,r,i);n._HTTP=s._HTTP;n.abort=s.abort;return n}else{throw new Error("Message is not set or Receivers not added")}}}})(r);var b={object:{create:function(e,t,r,i){e=e||{};i=i||{};if(i.class_uid&&e.application_api_key&&e.application_uid){var s=n.Base+n.classes+i.class_uid+n.objects;s=v(s);return w(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},fetch:function(e,t,r,i){e=e||{};i=i||{};if(i.class_uid&&e.application_api_key&&e.application_uid){var s=n.Base+n.classes+i.class_uid+n.objects+(i.object_uid?i.object_uid:"");s=v(s);return E(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},update:function(e,t,r,i){e=e||{};i=i||{};if(i.class_uid&&i.object_uid&&e.application_api_key&&e.application_uid){var s=n.Base+n.classes+i.class_uid+n.objects+i.object_uid;s=v(s);return x(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},destroy:function(e,t,r,i){e=e||{};i=i||{};if(i.class_uid&&i.object_uid&&e.application_api_key&&e.application_uid){var s=n.Base+n.classes+i.class_uid+n.objects+i.object_uid;s=v(s);return S(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},"class":{fetch:function(e,t,r,i){e=e||{};i=i||{};if(i.class_uid&&e.application_api_key&&e.application_uid){var s=n.Base+n.classes+i.class_uid;s=v(s);return E(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},file:{upload:function(e,t,r,i){e=e||{};i=i||{};if(i.class_uid&&e.application_api_key&&e.application_uid){var s=n.Base+n.upload;s=v(s);return w(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},user:{login:function(e,t,r,i){e=e||{};if(e.application_api_key&&e.application_uid){var s=n.Base+"/"+n.login;s=v(s);return w(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},logout:function(e,t,r,i){e=e||{};if(e.application_api_key&&e.application_uid&&e.authtoken){var s=n.Base+"/"+n.logout;s=v(s);return S(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},fetchUserInfo:function(e,t,r,i){e=e||{};if(e.application_api_key&&e.application_uid&&e.authtoken){var s=n.Base+"/"+n.getUserInfo;s=v(s);return E(s,e,{},r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},register:function(e,t,r,i){e=e||{};if(e.application_api_key&&e.application_uid){var s=n.Base+"/"+n.user;s=v(s);return w(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},forgetPassword:function(e,t,r,i){e=e||{};t=t||{};if(e.application_api_key&&e.application_uid&&t.application_user&&t.application_user.email){var s=n.Base+n.forgetPassword;s=v(s);return w(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},activate:function(e,t,r,i){e=e||{};t=t||{};i=i||{};if(e.application_api_key&&e.application_uid&&i.userId&&i.activationToken){var s=n.Base+"/application/users/"+i.userId+"/activate/"+i.activationToken;s=v(s);return E(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},deactivate:function(e,t,r,i){e=e||{};t=t||{};i=i||{};if(e.application_api_key&&e.application_uid&&e.authtoken&&i.userId){var s=n.Base+"/application/users/"+i.userId;s=v(s);return S(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},fetchUidByEmail:function(e,t,r){e=e||{};t=t||{};if(e.application_api_key&&e.application_uid&&e.authtoken){var i=n.Base+"/application/users/retrieve_user_uid";i=v(i);return w(i,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},as:{trigger:function(e,t,r){var i=n.Base+"/events/trigger_multiple";i=v(i);e=e||{};t=t||{};if(e.application_api_key&&e.application_uid){return w(i,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},app_setting:{fetch:function(e,t,r){e=e||{};r=r||{};if(e.application_api_key&&e.application_uid){var i=n.Base+"/applications/"+e.application_uid;i=v(i);return E(i,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},upload:{fetch:function(e,t,r,i){e=e||{};i=i||{};if(e.application_api_key&&e.application_uid&&i.uid){var s=n.Base+n.upload+i.uid;s=v(s);return E(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this},destroy:function(e,t,r,i){e=e||{};i=i||{};if(e.application_api_key&&e.application_uid&&i.uid){var s=n.Base+n.upload+i.uid;s=v(s);return S(s,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}return this}},notification:{send:function(e,t,r){e=e||{};if(e.application_api_key&&e.application_uid){var i=n.Base+n.notification;i=v(i);return w(i,e,t,r)}else{if(typeof r=="function"){r({error_message:"provide all parameters"})}}}}};var w=function(e,t,n,r){return u(e,t,n,"POST",r)};var E=function(e,t,n,r){return u(e,t,n,"GET",r)};var S=function(e,t,n,r){return u(e,t,n,"DELETE",r)};var x=function(e,t,n,r){return u(e,t,n,"PUT",r)};var T=function(e,t,i,s,o){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}if(typeof o!="function"){o=function(){}}s=s.toUpperCase();i=i||{};t=t||{};if(typeof XDomainRequest!=="undefined"){return N(e,t,i,s,o)}try{var u=new XMLHttpRequest;if(s!="POST"){i["_method"]=s.toUpperCase();s="POST"}u.open(s,e,true);u.setRequestHeader("Content-Type","application/json");if(r.Util.dataType(t)=="object"){for(var a in t){u.setRequestHeader(a,t[a])}}i=JSON.stringify(i);u.onreadystatechange=function(n){if(u.readyState==4){if(u.status!=0){o(u.responseText,u)}else if(u.status==0&&u["__aborted__"]==false){try{i=JSON.parse(i)}catch(n){}var r=i["_method"];try{delete i._method}catch(n){}f=true;N(e,t,i,r,o)}}};u.ontimeout=function(e){var t={error_message:"error http timeout",http:u,event:e};o(t,u)};u.onerror=function(e){var t={error_message:"error http client",http:u,event:e};o(t,u)};u.__aborted__=false;u.send(i);return{_HTTP:true,abort:function(){u.__aborted__=true;u.abort()}}}catch(l){f=true;return N(e,t,i,s,o)}};var N=function(e,t,n,i,s){try{n=JSON.parse(n)}catch(o){}try{delete n._method}catch(o){}var u=d().toString();if(typeof r.cbTray!="object"){r.cbTray={}}r.cbTray[u]=s;var a=C(e,t,n,i,u);var f=k(e,t,n,i,u);f.submit();return function(e){return{_HTTP:false,abort:function(){if(typeof r.cbTray[e]==="function"){r.cbTray[e]=function(){try{delete r.cbTray[e]}catch(t){}};try{var t=document.getElementById("frame_"+e);t.parentNode.removeChild(t)}catch(n){}try{var i=document.getElementById("form_"+e);i.parentNode.removeChild(i)}catch(n){}}}}}(u)};var C=function(e,t,r,i,s){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}try{i=i.toUpperCase()}catch(o){i="POST"}var u=L("frame_"+s);u.setAttribute("width","0");u.setAttribute("height","0");u.setAttribute("style","display:none");document.body.appendChild(u);return u};var k=function(e,t,r,i,s){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}try{i=i.toUpperCase()}catch(o){i="POST"}var u=document.createElement("form");u.setAttribute("id","form_"+s);u.setAttribute("target","frame_"+s);u.setAttribute("method","post");if(e.charAt(e.length-1)=="/"){e=e.substring(0,e.length-1)}e=e+".postmessage";u.setAttribute("action",e);for(var a in t){try{u.appendChild(A(a.toString().toUpperCase(),t[a]))}catch(o){}}r=r||{};var f=typeof r=="object"?JSON.stringify(r):r;u.appendChild(A("PARAM",f));u.appendChild(A("postmessage_payload",s));u.appendChild(A("_method",i));u.appendChild(A("host",document.location.origin?document.location.origin:document.location.protocol+"//"+document.location.host));document.body.appendChild(u);return u};var L=function(e){var t;try{t=document.createElement('<iframe name="'+e+'" id="'+e+'" />')}catch(n){t=document.createElement("iframe");t.id=e;t.name=e}return t};var A=function(e,t){var n;try{n=document.createElement('<input type="hidden" name="'+e+'" />')}catch(r){n=document.createElement("input");n.type="hidden";n.name=e}n.value=t;return n};var O=function(){var e=function(e){var t=e.data?e.data:e.message;try{t=JSON.parse(t)}catch(e){}if(typeof t=="object"){var n=t.postmessage_payload;try{delete t["postmessage_payload"]}catch(e){}if(typeof r.cbTray[n]=="function"){try{t=JSON.parse(t)}catch(e){}r.cbTray[n](t,{});try{delete r.cbTray[n]}catch(e){}try{var i=document.getElementById("frame_"+n);i.parentNode.removeChild(i)}catch(e){}try{var s=document.getElementById("form_"+n);s.parentNode.removeChild(s)}catch(e){}}else{}}else{}};if(typeof window.addEventListener!=="undefined"){window.addEventListener("message",e,false)}else{window.attachEvent("onmessage",e)}};if(l==false){O()}var M=function(e,t,i,s,o){if(n.host==""||typeof n.host!=="string"||n.host.length<=0){throw new Error("Set host for built server first. eg: Built.setURL('built.io')");return}t=t||{};s=s.toUpperCase();i=i||{};if(m(p)==false){var u=r.Util.param(p);e+="?"+u}if(s!="POST"){i["_method"]=s.toUpperCase();s="POST"}t["Content-Type"]="application/json";i=JSON.stringify(i);return a.post({url:e,headers:t,body:i,json:true},function(e,t,n){o(n?n:e,t)})};if(l){u=M}else{u=T}var _={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,s,o,u,a="",f=0;for(e=_._utf8_encode(e);e.length>f;)t=e.charCodeAt(f++),n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=t>>2,s=(3&t)<<4|n>>4,o=(15&n)<<2|r>>6,u=63&r,isNaN(n)?o=u=64:isNaN(r)&&(u=64),a=a+this._keyStr.charAt(i)+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u);return a},decode:function(e){var t,n,r,i,s,o,u,a="",f=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");e.length>f;)i=this._keyStr.indexOf(e.charAt(f++)),s=this._keyStr.indexOf(e.charAt(f++)),o=this._keyStr.indexOf(e.charAt(f++)),u=this._keyStr.indexOf(e.charAt(f++)),t=i<<2|s>>4,n=(15&s)<<4|o>>2,r=(3&o)<<6|u,a+=String.fromCharCode(t),64!=o&&(a+=String.fromCharCode(n)),64!=u&&(a+=String.fromCharCode(r));return a=_._utf8_decode(a)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;e.length>n;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(192|r>>6),t+=String.fromCharCode(128|63&r)):(t+=String.fromCharCode(224|r>>12),t+=String.fromCharCode(128|63&r>>6),t+=String.fromCharCode(128|63&r))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;e.length>n;)r=e.charCodeAt(n),128>r?(t+=String.fromCharCode(r),n++):r>191&&224>r?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t}};var D={get:function(e){if(typeof localStorage!=="undefined"){return localStorage.getItem(e)||null}else{return null}},set:function(e,t){if(typeof localStorage!=="undefined"&&e&&t){return localStorage.setItem(e,t)}else{return null}}};if(typeof define==="function"&&define.amd){define("Built",[],function(){return r})}})(typeof window==="undefined"?this:window)